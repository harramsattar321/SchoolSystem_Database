SELECT s.school_name, g.game_name FROM school s INNER JOIN ( SELECT emis_code, game_id FROM gameschool WHERE game_id IN ( SELECT game_id FROM game WHERE game_name = 'Cricket' ) ) gs ON s.emis_code = gs.emis_code INNER JOIN game g ON gs.game_id = g.game_id;
SELECT S.School_Name, S.Total_Students    FROM School S    ORDER BY S.Total_Students DESC;
SELECT s.school_level, AVG(h.head_grade) AS avg_grade FROM school s LEFT JOIN ( SELECT emis_code, head_grade FROM head ) h ON s.emis_code = h.emis_code GROUP BY s.school_level;
SELECT s.school_name, c.district FROM school s INNER JOIN contact_info c ON s.emis_code = c.emis_code INNER JOIN ( SELECT DISTINCT emis_code FROM gameschool gs INNER JOIN game g ON gs.game_id = g.game_id WHERE g.game_name = 'Football' ) football ON s.emis_code = football.emis_code WHERE c.district IN ('Faisalabad', 'Rawalpindi');
SELECT s.school_name, b.total_rooms, s.Total_students FROM school s INNER JOIN building b ON s.emis_code = b.emis_code WHERE b.total_rooms = ( SELECT MAX(total_rooms) FROM building ) AND s.Total_students > ( SELECT AVG(Total_students) FROM school );
SELECT S.School_Name, L.Lab_Name    FROM School S    JOIN Building B ON S.Emis_Code = B.Emis_Code     JOIN Building_Lab BL ON B.Building_id = BL.Building_id    JOIN Lab L ON BL.Lab_ID = L.Lab_ID;
SELECT s.school_name, b.covered_area, s.School_Shift FROM school s INNER JOIN building b ON s.emis_code = b.emis_code WHERE b.building_id IN ( SELECT DISTINCT bl.building_id FROM building_lab bl INNER JOIN lab l ON bl.lab_id = l.lab_id WHERE l.lab_name = 'Computer' ) AND s.School_Shift = 'Morning';
SELECT s.school_name, s.Total_students, s.Total_Teachers, s.Total_students / s.Total_Teachers AS students_per_teacher FROM school s WHERE s.Total_students / s.Total_Teachers = ( SELECT MAX(Total_students / Total_Teachers) FROM school );
SELECT s.school_name, s.school_level, b.total_rooms FROM school s INNER JOIN building b ON s.emis_code = b.emis_code WHERE (s.school_level, b.total_rooms) IN ( SELECT school_level, MAX(total_rooms) FROM school s2 INNER JOIN building b2 ON s2.emis_code = b2.emis_code GROUP BY school_level );
SELECT s.school_level, AVG(b.covered_area) AS avg_covered_area FROM school s INNER JOIN building b ON s.emis_code = b.emis_code GROUP BY s.school_level HAVING AVG(b.covered_area) > ( SELECT AVG(covered_area) FROM building );
